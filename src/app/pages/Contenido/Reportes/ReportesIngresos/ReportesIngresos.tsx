import { FC, useContext, useEffect, useState } from "react";
import "./ReportesIngresos.css";
import { PageTitle } from "../../../components/PageTitle/PageTitle";
import { Link } from "react-router-dom";
import { ReportesIngresosContext } from "./ReportesIngresosContext";
import { FiltroVenta } from "./FiltroVenta/FiltroVenta";
import { FiltroCuentasPorCobrar } from "./FiltroCuentasPorCobrar/FiltroCuentasPorCobrar";
import { FiltroPrestamos } from "./FiltroPrestamos/FiltroPrestamos";
import { FiltroEgresosGastos } from "./FiltroEgresosGastos/FiltroEgresosGastos";
import Modal from "../../../EntryComponents/Modal";
import FiltroClientes from "./FiltroClientes/FiltroClientes";
import { Zone } from "../../../../../type/City";
import { User } from "../../../../../type/User";
import { AccountEntryApiConector, ProvidersApiConector, UsersApiConector, ZonesApiConector } from "../../../../../api/classes";
import { Account } from "../../../../../type/AccountEntry";
import { Providers } from "../../../../../type/providers";

const ReportesIngresos: FC = () => {
  const {
    clientes,
    setClientes,
    egresosGastos,
    setEgresosGastos,
    prestamos,
    setPrestamos,
    cuentasPorCobrarCobros,
    setCuentasPorCobrarCobros,
    ventas,
    setVentas,
  } = useContext(ReportesIngresosContext);

  const [zones, setZones] = useState<Zone[]>([])
  const [providers, setProviders] = useState<Providers[]>([])
  const [accounts, setAccounts] = useState<Account[]>([])
  const [distribuidores, setDistribuidores] = useState<User[]>([])

  useEffect(() => {
    ZonesApiConector.get({ pagination: { page: 1, pageSize: 3000 } }).then(res => setZones(res?.data || []))
    UsersApiConector.get({ pagination: { page: 1, pageSize: 3000 }, filters: { desactivated: false } }).then(res => setDistribuidores(res?.data || []))
    ProvidersApiConector.get({ pagination: { page: 1, pageSize: 3000 } }).then(res => setProviders(res?.data || []))
    AccountEntryApiConector.get().then(res => setAccounts(res || []))
  }, [])

  return (
    <>
      <div className="px-10">
        <PageTitle
          titulo="Reportes ingresos / C. por cobrar"
          icon="/Reportes-icon.svg"
        />
        <div className="ReportesIngresos-container py-4 overflow-auto">
          <button
            className="ReportesIngresos-item"
            onClick={() => setClientes(true)}
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="82" height="52" viewBox="0 0 82 52" fill="none"                            >
              <path d="M27.0638 7.89509C27.0638 5.97109 26.2006 4.12588 24.6641 2.76541C23.1277 1.40493 21.0438 0.640625 18.8709 0.640625C16.698 0.640625 14.6142 1.40493 13.0777 2.76541C11.5412 4.12588 10.6781 5.97109 10.6781 7.89509C10.6781 9.81909 11.5412 11.6643 13.0777 13.0248C14.6142 14.3852 16.698 15.1496 18.8709 15.1496C21.0438 15.1496 23.1277 14.3852 24.6641 13.0248C26.2006 11.6643 27.0638 9.81909 27.0638 7.89509ZM4.12377 26.0312C4.12377 28.0376 5.95436 29.6585 8.2202 29.6585H19.1782C20.4711 25.1925 24.1195 21.5539 28.8816 19.8423C27.6398 19.1622 26.1677 18.7768 24.6059 18.7768H12.3166C7.79776 18.7768 4.12377 22.03 4.12377 26.0312ZM63.2148 29.6585H73.7631C76.0289 29.6585 77.8595 28.0376 77.8595 26.0312C77.8595 22.03 74.1855 18.7768 69.6666 18.7768H57.3773C55.8796 18.7768 54.4714 19.1282 53.2681 19.7516C58.1454 21.4292 61.8962 25.1131 63.2148 29.6585ZM50.1062 22.6761C49.2229 22.4947 48.2884 22.404 47.3411 22.404H35.0518C33.9637 22.404 32.914 22.5287 31.9155 22.7554C27.9727 23.6735 24.7979 26.2806 23.4538 29.6585C23.0057 30.792 22.7497 32.0162 22.7497 33.2857C22.7497 35.292 24.5803 36.9129 26.8462 36.9129H55.5212C57.787 36.9129 59.6176 35.292 59.6176 33.2857C59.6176 32.0162 59.3744 30.792 58.9135 29.6585C57.531 26.1786 54.2026 23.5149 50.0934 22.6761H50.1062ZM72.1245 7.89509C72.1245 5.97109 71.2613 4.12588 69.7249 2.76541C68.1884 1.40493 66.1045 0.640625 63.9316 0.640625C61.7588 0.640625 59.6749 1.40493 58.1384 2.76541C56.6019 4.12588 55.7388 5.97109 55.7388 7.89509C55.7388 9.81909 56.6019 11.6643 58.1384 13.0248C59.6749 14.3852 61.7588 15.1496 63.9316 15.1496C66.1045 15.1496 68.1884 14.3852 69.7249 13.0248C71.2613 11.6643 72.1245 9.81909 72.1245 7.89509ZM41.1965 18.7768C43.9126 18.7768 46.5174 17.8214 48.438 16.1208C50.3586 14.4202 51.4375 12.1137 51.4375 9.7087C51.4375 7.3037 50.3586 4.9972 48.438 3.2966C46.5174 1.59601 43.9126 0.640625 41.1965 0.640625C38.4804 0.640625 35.8755 1.59601 33.9549 3.2966C32.0344 4.9972 30.9554 7.3037 30.9554 9.7087C30.9554 12.1137 32.0344 14.4202 33.9549 16.1208C35.8755 17.8214 38.4804 18.7768 41.1965 18.7768ZM4.12377 44.1674C1.85794 44.1674 0.0273438 45.7883 0.0273438 47.7946C0.0273438 49.801 1.85794 51.4219 4.12377 51.4219H77.8595C80.1253 51.4219 81.9559 49.801 81.9559 47.7946C81.9559 45.7883 80.1253 44.1674 77.8595 44.1674H4.12377Z" fill="currentColor" />
            </svg>
            <span>Clientes</span>
          </button>
          <button
            className="ReportesIngresos-item"
            onClick={() => setVentas(true)}
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="51"
              height="50"
              viewBox="0 0 51 50"
              fill="none"
            >
              <g clipPath="url(#clip0_43_4074)">
                <path
                  d="M6.26562 0C4.53711 0 3.14062 1.39648 3.14062 3.125V9.375C3.14062 11.1035 4.53711 12.5 6.26562 12.5H14.0781V15.625H8.51172C5.42578 15.625 2.79883 17.8809 2.33008 20.9375L0.123047 35.5566C0.0546875 36.0156 0.015625 36.4844 0.015625 36.9531V43.75C0.015625 47.1973 2.81836 50 6.26562 50H43.7656C47.2129 50 50.0156 47.1973 50.0156 43.75V36.9531C50.0156 36.4844 49.9766 36.0156 49.9082 35.5469L47.6914 20.9375C47.2324 17.8809 44.6055 15.625 41.5195 15.625H20.3281V12.5H28.1406C29.8691 12.5 31.2656 11.1035 31.2656 9.375V3.125C31.2656 1.39648 29.8691 0 28.1406 0H6.26562ZM9.39062 4.6875H25.0156C25.875 4.6875 26.5781 5.39062 26.5781 6.25C26.5781 7.10938 25.875 7.8125 25.0156 7.8125H9.39062C8.53125 7.8125 7.82812 7.10938 7.82812 6.25C7.82812 5.39062 8.53125 4.6875 9.39062 4.6875ZM6.26562 42.1875C6.26562 41.3281 6.96875 40.625 7.82812 40.625H42.2031C43.0625 40.625 43.7656 41.3281 43.7656 42.1875C43.7656 43.0469 43.0625 43.75 42.2031 43.75H7.82812C6.96875 43.75 6.26562 43.0469 6.26562 42.1875ZM10.9531 25.7812C10.3315 25.7812 9.73538 25.5343 9.29584 25.0948C8.85631 24.6552 8.60938 24.0591 8.60938 23.4375C8.60938 22.8159 8.85631 22.2198 9.29584 21.7802C9.73538 21.3407 10.3315 21.0938 10.9531 21.0938C11.5747 21.0938 12.1709 21.3407 12.6104 21.7802C13.0499 22.2198 13.2969 22.8159 13.2969 23.4375C13.2969 24.0591 13.0499 24.6552 12.6104 25.0948C12.1709 25.5343 11.5747 25.7812 10.9531 25.7812ZM22.6719 23.4375C22.6719 24.0591 22.4249 24.6552 21.9854 25.0948C21.5459 25.5343 20.9497 25.7812 20.3281 25.7812C19.7065 25.7812 19.1104 25.5343 18.6708 25.0948C18.2313 24.6552 17.9844 24.0591 17.9844 23.4375C17.9844 22.8159 18.2313 22.2198 18.6708 21.7802C19.1104 21.3407 19.7065 21.0938 20.3281 21.0938C20.9497 21.0938 21.5459 21.3407 21.9854 21.7802C22.4249 22.2198 22.6719 22.8159 22.6719 23.4375ZM15.6406 33.5938C15.019 33.5938 14.4229 33.3468 13.9833 32.9073C13.5438 32.4677 13.2969 31.8716 13.2969 31.25C13.2969 30.6284 13.5438 30.0323 13.9833 29.5927C14.4229 29.1532 15.019 28.9062 15.6406 28.9062C16.2622 28.9062 16.8584 29.1532 17.2979 29.5927C17.7374 30.0323 17.9844 30.6284 17.9844 31.25C17.9844 31.8716 17.7374 32.4677 17.2979 32.9073C16.8584 33.3468 16.2622 33.5938 15.6406 33.5938ZM32.0469 23.4375C32.0469 24.0591 31.7999 24.6552 31.3604 25.0948C30.9209 25.5343 30.3247 25.7812 29.7031 25.7812C29.0815 25.7812 28.4854 25.5343 28.0458 25.0948C27.6063 24.6552 27.3594 24.0591 27.3594 23.4375C27.3594 22.8159 27.6063 22.2198 28.0458 21.7802C28.4854 21.3407 29.0815 21.0938 29.7031 21.0938C30.3247 21.0938 30.9209 21.3407 31.3604 21.7802C31.7999 22.2198 32.0469 22.8159 32.0469 23.4375ZM25.0156 33.5938C24.394 33.5938 23.7979 33.3468 23.3583 32.9073C22.9188 32.4677 22.6719 31.8716 22.6719 31.25C22.6719 30.6284 22.9188 30.0323 23.3583 29.5927C23.7979 29.1532 24.394 28.9062 25.0156 28.9062C25.6372 28.9062 26.2334 29.1532 26.6729 29.5927C27.1124 30.0323 27.3594 30.6284 27.3594 31.25C27.3594 31.8716 27.1124 32.4677 26.6729 32.9073C26.2334 33.3468 25.6372 33.5938 25.0156 33.5938ZM41.4219 23.4375C41.4219 23.7453 41.3613 24.0501 41.2435 24.3344C41.1257 24.6188 40.953 24.8771 40.7354 25.0948C40.5178 25.3124 40.2594 25.4851 39.975 25.6028C39.6907 25.7206 39.3859 25.7812 39.0781 25.7812C38.7703 25.7812 38.4656 25.7206 38.1812 25.6028C37.8969 25.4851 37.6385 25.3124 37.4208 25.0948C37.2032 24.8771 37.0306 24.6188 36.9128 24.3344C36.795 24.0501 36.7344 23.7453 36.7344 23.4375C36.7344 23.1297 36.795 22.8249 36.9128 22.5406C37.0306 22.2562 37.2032 21.9979 37.4208 21.7802C37.6385 21.5626 37.8969 21.3899 38.1812 21.2722C38.4656 21.1544 38.7703 21.0938 39.0781 21.0938C39.3859 21.0938 39.6907 21.1544 39.975 21.2722C40.2594 21.3899 40.5178 21.5626 40.7354 21.7802C40.953 21.9979 41.1257 22.2562 41.2435 22.5406C41.3613 22.8249 41.4219 23.1297 41.4219 23.4375ZM34.3906 33.5938C33.769 33.5938 33.1729 33.3468 32.7333 32.9073C32.2938 32.4677 32.0469 31.8716 32.0469 31.25C32.0469 30.6284 32.2938 30.0323 32.7333 29.5927C33.1729 29.1532 33.769 28.9062 34.3906 28.9062C35.0122 28.9062 35.6084 29.1532 36.0479 29.5927C36.4874 30.0323 36.7344 30.6284 36.7344 31.25C36.7344 31.8716 36.4874 32.4677 36.0479 32.9073C35.6084 33.3468 35.0122 33.5938 34.3906 33.5938Z"
                  fill="currentColor"
                />
              </g>
              <defs>
                <clipPath id="clip0_43_4074">
                  <rect
                    width="50"
                    height="50"
                    fill="currentColor"
                    transform="translate(0.015625)"
                  />
                </clipPath>
              </defs>
            </svg>
            <span>Ventas</span>
          </button>
          <button
            className="ReportesIngresos-item"
            onClick={() => setCuentasPorCobrarCobros(true)}
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="44" height="52" viewBox="0 0 44 52" fill="none"                            >
              <path d="M1.78116 0.84155C2.73332 0.454715 3.85351 0.593579 4.64885 1.19863L9.17442 4.63056L13.7 1.19863C14.7082 0.434877 16.198 0.434877 17.195 1.19863L21.7206 4.63056L26.2461 1.19863C27.2543 0.434877 28.7329 0.434877 29.7411 1.19863L34.2667 4.63056L38.7923 1.19863C39.5876 0.593579 40.7078 0.454715 41.6599 0.84155C42.6121 1.22839 43.2282 2.07149 43.2282 3.00386V49.0274C43.2282 49.9598 42.6121 50.8029 41.6599 51.1897C40.7078 51.5765 39.5876 51.4377 38.7923 50.8326L34.2667 47.4007L29.7411 50.8326C28.7329 51.5964 27.2543 51.5964 26.2461 50.8326L21.7206 47.4007L17.195 50.8326C16.1868 51.5964 14.697 51.5964 13.7 50.8326L9.17442 47.4007L4.64885 50.8326C3.85351 51.4377 2.73332 51.5765 1.78116 51.1897C0.828996 50.8029 0.212891 49.9598 0.212891 49.0274V3.00386C0.212891 2.07149 0.828996 1.22839 1.78116 0.84155ZM10.9667 14.9065C9.98095 14.9065 9.17442 15.6207 9.17442 16.4935C9.17442 17.3664 9.98095 18.0805 10.9667 18.0805H32.4744C33.4602 18.0805 34.2667 17.3664 34.2667 16.4935C34.2667 15.6207 33.4602 14.9065 32.4744 14.9065H10.9667ZM9.17442 35.5377C9.17442 36.4106 9.98095 37.1248 10.9667 37.1248H32.4744C33.4602 37.1248 34.2667 36.4106 34.2667 35.5377C34.2667 34.6649 33.4602 33.9507 32.4744 33.9507H10.9667C9.98095 33.9507 9.17442 34.6649 9.17442 35.5377ZM10.9667 24.4286C9.98095 24.4286 9.17442 25.1428 9.17442 26.0156C9.17442 26.8885 9.98095 27.6026 10.9667 27.6026H32.4744C33.4602 27.6026 34.2667 26.8885 34.2667 26.0156C34.2667 25.1428 33.4602 24.4286 32.4744 24.4286H10.9667Z" fill="currentColor" />
            </svg>
            <span>Cuentas por cobrar</span>
          </button>
          <button
            className="ReportesIngresos-item"
            onClick={() => setPrestamos(true)}
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="58" height="50" viewBox="0 0 58 50" fill="none"                            >
              <path d="M26.1259 7.38636C26.7472 7.38636 27.2604 7.225 27.6657 6.90227C28.071 6.57955 28.2746 6.17273 28.2765 5.68182C28.2765 5.18939 28.0729 4.78258 27.6657 4.46136C27.2585 4.14015 26.7452 3.97879 26.1259 3.97727C25.5046 3.97727 24.9913 4.13864 24.586 4.46136C24.1807 4.78409 23.9771 5.19091 23.9752 5.68182C23.9752 6.17424 24.1788 6.58106 24.586 6.90227C24.9932 7.22348 25.5065 7.38485 26.1259 7.38636ZM43.3309 50C39.3642 50 35.9824 48.8917 33.1856 46.675C30.3889 44.4583 28.9914 41.7788 28.9934 38.6364C28.9934 35.4924 30.3917 32.8121 33.1885 30.5955C35.9853 28.3788 39.3661 27.2712 43.3309 27.2727C47.2976 27.2727 50.6793 28.3811 53.4761 30.5977C56.2728 32.8144 57.6703 35.4939 57.6684 38.6364C57.6684 41.7803 56.27 44.4606 53.4732 46.6773C50.6764 48.8939 47.2957 50.0015 43.3309 50ZM41.8971 45.4545H44.7646V39.7727H51.9334V37.5H44.7646V31.8182H41.8971V37.5H34.7284V39.7727H41.8971V45.4545ZM11.7884 18.1818H40.4634V13.6364H11.7884V18.1818ZM25.1939 45.4545H6.05336C4.47624 45.4545 3.12565 45.0091 2.00159 44.1182C0.877526 43.2273 0.316453 42.1576 0.318364 40.9091V9.09091C0.318364 7.84091 0.880394 6.77045 2.00445 5.87955C3.12851 4.98864 4.47815 4.54394 6.05336 4.54545H18.0969C18.7182 3.18182 19.7581 2.08333 21.2167 1.25C22.6753 0.416667 24.3117 0 26.1259 0C27.9419 0 29.5793 0.416667 31.0379 1.25C32.4965 2.08333 33.5355 3.18182 34.1549 4.54545H46.1984C47.7755 4.54545 49.1261 4.99091 50.2501 5.88182C51.3742 6.77273 51.9353 7.84242 51.9334 9.09091V24.3182C50.5474 23.7879 49.149 23.3902 47.7382 23.125C46.3274 22.8598 44.8583 22.7273 43.3309 22.7273C42.8051 22.7273 42.3148 22.7364 41.8598 22.7545C41.4049 22.7727 40.9394 22.8205 40.4634 22.8977V22.7273H11.7884V27.2727H29.3518C28.4915 27.9167 27.7145 28.6174 27.0205 29.375C26.3266 30.1326 25.7177 30.947 25.1939 31.8182H11.7884V36.3636H23.4734C23.3778 36.7424 23.3176 37.1121 23.2928 37.4727C23.2679 37.8333 23.2565 38.2212 23.2584 38.6364C23.2584 39.8864 23.4017 41.0515 23.6885 42.1318C23.9752 43.2121 24.477 44.3197 25.1939 45.4545Z" fill="currentColor" />
            </svg>
            <span>Préstamos</span>
          </button>
          <button
            className="ReportesIngresos-item"
            onClick={() => setEgresosGastos(true)}
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="79"
              height="50"
              viewBox="0 0 79 50"
              fill="none"
            >
              <g clipPath="url(#clip0_43_4078)">
                <path
                  d="M12.0684 9.375V31.25C12.0684 34.6973 15.5718 37.5 19.8809 37.5H70.6621C74.9712 37.5 78.4746 34.6973 78.4746 31.25V9.375C78.4746 5.92773 74.9712 3.125 70.6621 3.125H19.8809C15.5718 3.125 12.0684 5.92773 12.0684 9.375ZM19.8809 25C24.1899 25 27.6934 27.8027 27.6934 31.25H19.8809V25ZM27.6934 9.375C27.6934 12.8223 24.1899 15.625 19.8809 15.625V9.375H27.6934ZM70.6621 25V31.25H62.8496C62.8496 27.8027 66.353 25 70.6621 25ZM62.8496 9.375H70.6621V15.625C66.353 15.625 62.8496 12.8223 62.8496 9.375ZM35.5059 20.3125C35.5059 18.2405 36.5347 16.2534 38.3661 14.7882C40.1976 13.3231 42.6815 12.5 45.2715 12.5C47.8615 12.5 50.3454 13.3231 52.1768 14.7882C54.0082 16.2534 55.0371 18.2405 55.0371 20.3125C55.0371 22.3845 54.0082 24.3716 52.1768 25.8368C50.3454 27.3019 47.8615 28.125 45.2715 28.125C42.6815 28.125 40.1976 27.3019 38.3661 25.8368C36.5347 24.3716 35.5059 22.3845 35.5059 20.3125ZM6.20898 11.7188C6.20898 10.4199 4.90283 9.375 3.2793 9.375C1.65576 9.375 0.349609 10.4199 0.349609 11.7188V35.1562C0.349609 41.6309 6.90478 46.875 14.998 46.875H63.8262C65.4497 46.875 66.7559 45.8301 66.7559 44.5312C66.7559 43.2324 65.4497 42.1875 63.8262 42.1875H14.998C10.1396 42.1875 6.20898 39.043 6.20898 35.1562V11.7188Z"
                  fill="currentColor"
                />
              </g>
              <defs>
                <clipPath id="clip0_43_4078">
                  <rect
                    width="78.125"
                    height="50"
                    fill="currentColor"
                    transform="translate(0.349609)"
                  />
                </clipPath>
              </defs>
            </svg>
            <span>Egresos y gastos</span>
          </button>
          <Link to={"/Reportes/Ingresos/Graficos"}>
            <div className="ReportesIngresos-item">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="88"
                height="76"
                viewBox="0 0 88 76"
                fill="none"
              >
                <path
                  d="M27.1202 50.6667L38.1983 41.0083L45.4626 47.3417L58.3568 36.1792V41.1667H65.6212V25.3333H47.4603V31.6667H53.181L45.4626 38.3958L38.1983 32.0625L22.0352 46.2333L27.1202 50.6667ZM11.1387 66.5V9.5H76.5177V66.5H11.1387ZM18.403 60.1667H69.2533V15.8333H18.403V60.1667Z"
                  fill="currentColor"
                />
              </svg>
              <span>Gráficos</span>
            </div>
          </Link>
        </div>
      </div>
      <Modal isOpen={clientes} onClose={() => setClientes(false)}>
        <FiltroClientes distribuidores={distribuidores} zones={zones} />
      </Modal>
      <Modal isOpen={ventas} onClose={() => setVentas(false)}>
        <FiltroVenta distribuidores={distribuidores} zones={zones} />
      </Modal>
      <Modal isOpen={cuentasPorCobrarCobros} onClose={() => setCuentasPorCobrarCobros(false)}>
        <FiltroCuentasPorCobrar distribuidores={distribuidores} zones={zones} />
      </Modal>
      <Modal isOpen={prestamos} onClose={() => setPrestamos(false)}>
        <FiltroPrestamos distribuidores={distribuidores} zones={zones} />
      </Modal>
      <Modal isOpen={egresosGastos} onClose={() => setEgresosGastos(false)}>
        <FiltroEgresosGastos distribuidores={distribuidores} zones={zones} accounts={accounts} providers={providers} />
      </Modal>
    </>
  );
};

export { ReportesIngresos };
